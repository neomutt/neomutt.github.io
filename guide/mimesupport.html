---
title: NeoMutt's MIME Support
---
{% raw %}
<div class="chapter">
  <div class="titlepage">
    <div>
      <div>
        <h1 class="title">
        <a id="guide/mimesupport"></a>NeoMutt's MIME Support</h1>
      </div>
    </div>
  </div>
  <p>Quite a bit of effort has been made to make NeoMutt the premier text-mode MIME MUA. Every effort has been made to provide the functionality that the discerning MIME user requires, and the conformance to the standards wherever possible. When configuring NeoMutt for MIME, there are two extra types of configuration files which NeoMutt uses. One is the
  <code class="literal">mime.types</code> file, which contains the mapping of file extensions to IANA MIME types. The other is the
  <code class="literal">mailcap</code> file, which specifies the external commands to use for handling specific MIME types.</p>
  <div class="sect1">
    <div class="titlepage">
      <div>
        <div>
          <h2 class="title" style="clear: both">
          <a id="using-mime"></a>1.&#160;Using MIME in NeoMutt</h2>
        </div>
      </div>
    </div>
    <div class="sect2">
      <div class="titlepage">
        <div>
          <div>
            <h3 class="title">
            <a id="mime-overview"></a>1.1.&#160;MIME Overview</h3>
          </div>
        </div>
      </div>
      <p>MIME is short for
      <span class="quote">“<span class="quote">Multipurpose Internet Mail Extension</span>”</span> and describes mechanisms to internationalize and structure mail messages. Before the introduction of MIME, messages had a single text part and were limited to us-ascii header and content. With MIME, messages can have attachments (and even attachments which itself have attachments and thus form a tree structure), nearly arbitrary characters can be used for sender names, recipients and subjects.</p>
      <p>Besides the handling of non-ascii characters in message headers, to NeoMutt the most important aspect of MIME are so-called MIME types. These are constructed using a
      <span class="emphasis">
        <em>major</em>
      </span>and
      <span class="emphasis">
        <em>minor</em>
      </span>type separated by a forward slash. These specify details about the content that follows. Based upon these, NeoMutt decides how to handle this part. The most popular major type is
      <span class="quote">“<span class="quote">
        <code class="literal">text</code>
      </span>”</span> with minor types for plain text, HTML and various other formats. Major types also exist for images, audio, video and of course general application data (e.g. to separate cryptographically signed data with a signature, send office documents, and in general arbitrary binary data). There's also the
      <code class="literal">multipart</code> major type which represents the root of a subtree of MIME parts. A list of supported MIME types can be found in
      <a class="xref" href="#supported-mime-types" title="Table&#160;5.1.&#160;Supported MIME types">Table&#160;5.1, “Supported MIME types”</a>.</p>
      <p>MIME also defines a set of encoding schemes for transporting MIME content over the network:
      <code class="literal">7bit</code>,
      <code class="literal">8bit</code>,
      <code class="literal">quoted-printable</code>,
      <code class="literal">base64</code> and
      <code class="literal">binary</code>. There're some rules when to choose what for encoding headers and/or body (if needed), and NeoMutt will in general make a good choice.</p>
      <p>NeoMutt does most of MIME encoding/decoding behind the scenes to form messages conforming to MIME on the sending side. On reception, it can be flexibly configured as to how what MIME structure is displayed (and if it's displayed): these decisions are based on the content's MIME type. There are three areas/menus in dealing with MIME: the pager (while viewing a message), the attachment menu and the compose menu.</p>
    </div>
    <div class="sect2">
      <div class="titlepage">
        <div>
          <div>
            <h3 class="title">
            <a id="mime-pager"></a>1.2.&#160;Viewing MIME Messages in the Pager</h3>
          </div>
        </div>
      </div>
      <p>When you select a message from the index and view it in the pager, NeoMutt decodes as much of a message as possible to a text representation. NeoMutt internally supports a number of MIME types, including the
      <code class="literal">text/plain</code> type, the
      <code class="literal">message/rfc822</code> (mail messages) type and some
      <code class="literal">multipart</code> types. In addition, it recognizes a variety of PGP MIME and S/MIME types, including PGP/MIME and
      <code class="literal">application/pgp</code>, and
      <code class="literal">application/pkcs7-mime</code>.</p>
      <p>NeoMutt will denote attachments with a couple lines describing them. These lines are of the form:</p>
      <pre class="screen">
[-- Attachment #1: Description --]
[-- Type: text/plain, Encoding: 7bit, Size: 10000 --]
</pre>
      <p>Where the
      <span class="emphasis">
        <em>Description</em>
      </span>is the description or filename given for the attachment, and the
      <span class="emphasis">
        <em>Encoding</em>
      </span>is one of the already mentioned content encodings.</p>
      <p>If NeoMutt cannot deal with a MIME type, it will display a message like:</p>
      <pre class="screen">
[-- image/gif is unsupported (use 'v' to view this part) --]
</pre>
    </div>
    <div class="sect2">
      <div class="titlepage">
        <div>
          <div>
            <h3 class="title">
            <a id="attach-menu"></a>1.3.&#160;The Attachment Menu</h3>
          </div>
        </div>
      </div>
      <p>The default binding for
      <code class="literal">&lt;view-attachments&gt;</code> is
      <span class="quote">“<span class="quote">v</span>”</span>, which displays the attachment menu for a message. The attachment menu displays a list of the attachments in a message. From the attachment menu, you can save, print, pipe, delete, and view attachments. You can apply these operations to a group of attachments at once, by tagging the attachments and by using the
      <code class="literal">&lt;tag-prefix&gt;</code> operator. You can also reply to the current message from this menu, and only the current attachment (or the attachments tagged) will be quoted in your reply. You can view attachments as text, or view them using the mailcap viewer definition (the mailcap mechanism is explained later in detail).</p>
      <p>Finally, you can apply the usual message-related functions (like
      <a class="link" href="gettingstarted.html#resend-message">
        <code class="literal">&lt;resend-message&gt;</code>
      </a>, and the
      <code class="literal">&lt;reply&gt;</code> and
      <code class="literal">&lt;forward-message&gt;</code> functions) to attachments of type
      <code class="literal">message/rfc822</code>.</p>
      <p>See table
      <a class="xref" href="reference.html#tab-attachment-bindings" title="Table&#160;46.7.&#160;Default Attachment Menu Bindings">Table&#160;46.7, “Default Attachment Menu Bindings”</a> for all available functions.</p>
      <div class="sect3">
        <div class="titlepage">
          <div>
            <div>
              <h4 class="title">
              <a id="attach-viewers"></a>1.3.1.&#160;Viewing Attachments</h4>
            </div>
          </div>
        </div>
        <p>There are four(!) ways of viewing attachments, so the functions deserve some extra explanation.</p>
        <div class="variablelist">
          <dl class="variablelist">
            <dt>
              <span class="term">
              <code class="literal">&lt;view-mailcap&gt;</code> (default keybinding: m)</span>
            </dt>
            <dd>
              <p>This will use the first matching mailcap entry.</p>
              <p>If no matching mailcap entries are found, it will abort with an error message.</p>
            </dd>
            <dt>
              <span class="term">
              <code class="literal">&lt;view-attach&gt;</code> (default keybinding: &lt;Enter&gt;)</span>
            </dt>
            <dd>
              <p>NeoMutt will display internally supported MIME types (see
              <a class="xref" href="#mime-pager" title="1.2.&#160;Viewing MIME Messages in the Pager">Section&#160;1.2, “Viewing MIME Messages in the Pager”</a>) in the pager. This will respect
              <a class="link" href="#auto-view" title="4.&#160;MIME Autoview">auto_view</a> settings, to determine whether to use a
              <code class="literal">copiousoutput</code> mailcap entry or just directly display the attachment.</p>
              <p>Other MIME types will use the first matching mailcap entry.</p>
              <p>If no matching mailcap entries are found, the attachment will be displayed in the pager as raw text.</p>
            </dd>
            <dt>
              <span class="term">
                <code class="literal">&lt;view-pager&gt;</code>
              </span>
            </dt>
            <dd>
              <p>NeoMutt will use the first matching
              <code class="literal">copiousoutput</code> mailcap entry to display the attachment in the pager (regardless of
              <a class="link" href="#auto-view" title="4.&#160;MIME Autoview">auto_view</a> settings).</p>
              <p>If no matching mailcap entries are found, the attachment will be displayed in the pager as raw text.</p>
            </dd>
            <dt>
              <span class="term">
              <code class="literal">&lt;view-text&gt;</code> (default keybinding: T)</span>
            </dt>
            <dd>
              <p>The attachment will always be displayed in the pager as raw text.</p>
            </dd>
          </dl>
        </div>
      </div>
      <div class="sect3">
        <div class="titlepage">
          <div>
            <div>
              <h4 class="title">
              <a id="attach-saving"></a>1.3.2.&#160;Saving Attachments</h4>
            </div>
          </div>
        </div>
        <div class="variablelist">
          <dl class="variablelist">
            <dt>
              <span class="term">
              <code class="literal">&lt;save-entry&gt;</code> (default keybinding: s)</span>
            </dt>
            <dd>
              <p>This will save the attachment to disk.</p>
              <p>The permissions of the saved file will depend on the user's
              <code class="literal">umask</code>. e.g.
              <code class="literal">umask 022</code> will create a file with permissions
              <code class="literal">rw-r--r--</code>.</p>
              <p>See also:
              <a class="link" href="reference.html#attach-save-dir" title="3.28.&#160;attach_save_dir">$attach_save_dir</a>,
              <a class="link" href="reference.html#attach-save-without-prompting" title="3.29.&#160;attach_save_without_prompting">$attach_save_without_prompting</a>,
              <a class="link" href="reference.html#attach-sep" title="3.30.&#160;attach_sep">$attach_sep</a>,
              <a class="link" href="reference.html#attach-split" title="3.31.&#160;attach_split">$attach_split</a></p>
            </dd>
          </dl>
        </div>
      </div>
    </div>
    <div class="sect2">
      <div class="titlepage">
        <div>
          <div>
            <h3 class="title">
            <a id="compose-menu"></a>1.4.&#160;The Compose Menu</h3>
          </div>
        </div>
      </div>
      <p>The compose menu is the menu you see before you send a message. It allows you to edit the recipient list, the subject, and other aspects of your message. It also contains a list of the attachments of your message, including the main body. From this menu, you can print, copy, filter, pipe, edit, compose, review, and rename an attachment or a list of tagged attachments. You can also modifying the attachment information, notably the type, encoding and description.</p>
      <p>Attachments appear as follows by default:</p>
      <pre class="screen">
- 1 [text/plain, 7bit, 1K]           /tmp/neomutt-euler-8082-0 &lt;no description&gt;
  2 [applica/x-gunzip, base64, 422K] ~/src/neomutt-0.85.tar.gz &lt;no description&gt;
</pre>
      <p>The
      <span class="quote">“<span class="quote">-</span>”</span> denotes that NeoMutt will delete the file after sending (or postponing, or canceling) the message. It can be toggled with the
      <code class="literal">&lt;toggle-unlink&gt;</code> command (default: u). The next field is the MIME content-type, and can be changed with the
      <code class="literal">&lt;edit-type&gt;</code> command (default: ^T). The next field is the encoding for the attachment, which allows a binary message to be encoded for transmission on 7bit links. It can be changed with the
      <code class="literal">&lt;edit-encoding&gt;</code> command (default: ^E). The next field is the size of the attachment, rounded to kilobytes or megabytes. The next field is the filename, which can be changed with the
      <code class="literal">&lt;rename-file&gt;</code> command (default: R). The final field is the description of the attachment, and can be changed with the
      <code class="literal">&lt;edit-description&gt;</code> command (default: d). See
      <a class="link" href="reference.html#attach-format" title="3.26.&#160;attach_format">$attach_format</a> for a full list of available expandos to format this display to your needs.</p>
    </div>
  </div>
  <div class="sect1">
    <div class="titlepage">
      <div>
        <div>
          <h2 class="title" style="clear: both">
          <a id="mime-types"></a>2.&#160;MIME Type Configuration with
          <code class="literal">mime.types</code></h2>
        </div>
      </div>
    </div>
    <p>To get most out of MIME, it's important that a MIME part's content type matches the content as closely as possible so that the recipient's client can automatically select the right viewer for the content. However, there's no reliable way for NeoMutt to know how to detect every possible file type. Instead, it uses a simple plain text mapping file that specifies what file extension corresponds to what MIME type. This file is called
    <code class="literal">mime.types</code>.</p>
    <p>When you add an attachment to your mail message, NeoMutt searches the system
    <code class="literal">mime.types</code> file at
    <code class="literal">/etc/mime.types</code>,
    <code class="literal">$SYSCONFDIR/mime.types</code> or
    <code class="literal">$PKGDATADIR/mime.types</code> and then your personal
    <code class="literal">mime.types</code> file at
    <code class="literal">$HOME/.mime.types</code>.</p>
    <p>Where
    <code class="literal">$HOME</code> is your home directory. The
    <code class="literal">$PKGDATADIR</code> and the
    <code class="literal">$SYSCONFDIR</code> directories depend on where NeoMutt is installed: the former is the default for shared data, the latter for system configuration files.</p>
    <p>Each line starts with the full MIME type, followed by a space and space-separated list of file extensions. For example you could use:</p>
    <div class="example">
      <a id="ex-mime-types"></a>
      <p class="title">
        <strong>Example&#160;5.1.&#160;
        <code class="literal">mime.types</code></strong>
      </p>
      <div class="example-contents">
        <pre class="screen">
application/postscript          ps eps
application/pgp                 pgp
audio/x-aiff                    aif aifc aiff
</pre>
      </div>
    </div>
    <br class="example-break" />
    <p>A sample
    <code class="literal">mime.types</code> file comes with the NeoMutt distribution, and should contain most of the MIME types you are likely to use.</p>
    <p>If NeoMutt can not determine the MIME type by the extension of the file you attach, it will run the command specified in
    <a class="link" href="reference.html#mime-type-query-command" title="3.258.&#160;mime_type_query_command">$mime_type_query_command</a>. If that command is not specified, NeoMutt will look at the file. If the file is free of binary information, NeoMutt will assume that the file is plain text, and mark it as
    <code class="literal">text/plain</code>. If the file contains binary information, then NeoMutt will mark it as
    <code class="literal">application/octet-stream</code>. You can change the MIME type that NeoMutt assigns to an attachment by using the
    <code class="literal">&lt;edit-type&gt;</code> command from the compose menu (default: ^T), see
    <a class="xref" href="#supported-mime-types" title="Table&#160;5.1.&#160;Supported MIME types">Table&#160;5.1, “Supported MIME types”</a> for supported major types. NeoMutt recognizes all of these if the appropriate entry is found in the
    <code class="literal">mime.types</code> file. Non-recognized mime types should only be used if the recipient of the message is likely to be expecting such attachments.</p>
    <div >
      <a id="supported-mime-types"></a>
      <p class="title">
        <strong>Table&#160;5.1.&#160;Supported MIME types</strong>
      </p>
      <div class="table-contents">
        <table summary="Supported MIME types" border="1">
          <colgroup>
            <col />
            <col />
            <col />
          </colgroup>
          <thead>
            <tr>
              <th>MIME major type</th>
              <th>Standard</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                <code class="literal">application</code>
              </td>
              <td>yes</td>
              <td>General application data</td>
            </tr>
            <tr>
              <td>
                <code class="literal">audio</code>
              </td>
              <td>yes</td>
              <td>Audio data</td>
            </tr>
            <tr>
              <td>
                <code class="literal">image</code>
              </td>
              <td>yes</td>
              <td>Image data</td>
            </tr>
            <tr>
              <td>
                <code class="literal">message</code>
              </td>
              <td>yes</td>
              <td>Mail messages, message status information</td>
            </tr>
            <tr>
              <td>
                <code class="literal">model</code>
              </td>
              <td>yes</td>
              <td>VRML and other modeling data</td>
            </tr>
            <tr>
              <td>
                <code class="literal">multipart</code>
              </td>
              <td>yes</td>
              <td>Container for other MIME parts</td>
            </tr>
            <tr>
              <td>
                <code class="literal">text</code>
              </td>
              <td>yes</td>
              <td>Text data</td>
            </tr>
            <tr>
              <td>
                <code class="literal">video</code>
              </td>
              <td>yes</td>
              <td>Video data</td>
            </tr>
            <tr>
              <td>
                <code class="literal">chemical</code>
              </td>
              <td>no</td>
              <td>Mostly molecular data</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <br class="table-break" />
    <p>MIME types are not arbitrary, they need to be assigned by
    <a class="ulink" href="http://www.iana.org/assignments/media-types/" target="_top">IANA</a>.</p>
  </div>
  <div class="sect1">
    <div class="titlepage">
      <div>
        <div>
          <h2 class="title" style="clear: both">
          <a id="mailcap"></a>3.&#160;MIME Viewer Configuration with Mailcap</h2>
        </div>
      </div>
    </div>
    <p>NeoMutt supports RFC1524 MIME Configuration, in particular the Unix specific format specified in Appendix A of RFC1524. This file format is commonly referred to as the
    <span class="quote">“<span class="quote">mailcap</span>”</span> format. Many MIME compliant programs utilize the mailcap format, allowing you to specify handling for all MIME types in one place for all programs. Programs known to use this format include Firefox, lynx and metamail.</p>
    <p>In order to handle various MIME types that NeoMutt doesn't have built-in support for, it parses a series of external configuration files to find an external handler. The default search string for these files is a colon delimited list containing the following files:</p>
    <div class="orderedlist">
      <ol class="orderedlist" type="1">
        <li class="listitem">
          <p>
            <code class="literal">$HOME/.mailcap</code>
          </p>
        </li>
        <li class="listitem">
          <p>
            <code class="literal">$PKGDATADIR/mailcap</code>
          </p>
        </li>
        <li class="listitem">
          <p>
            <code class="literal">$SYSCONFDIR/mailcap</code>
          </p>
        </li>
        <li class="listitem">
          <p>
            <code class="literal">/etc/mailcap</code>
          </p>
        </li>
        <li class="listitem">
          <p>
            <code class="literal">/usr/etc/mailcap</code>
          </p>
        </li>
        <li class="listitem">
          <p>
            <code class="literal">/usr/local/etc/mailcap</code>
          </p>
        </li>
      </ol>
    </div>
    <p>where
    <code class="literal">$HOME</code> is your home directory. The
    <code class="literal">$PKGDATADIR</code> and the
    <code class="literal">$SYSCONFDIR</code> directories depend on where NeoMutt is installed: the former is the default for shared data, the latter for system configuration files.</p>
    <p>The default search path can be obtained by running the following command:</p>
    <pre class="screen">
neomutt -nF /dev/null -Q mailcap_path
</pre>
    <p>In particular, the metamail distribution will install a mailcap file, usually as
    <code class="literal">/usr/local/etc/mailcap</code>, which contains some baseline entries.</p>
    <div class="sect2">
      <div class="titlepage">
        <div>
          <div>
            <h3 class="title">
            <a id="mailcap-basics"></a>3.1.&#160;The Basics of the Mailcap File</h3>
          </div>
        </div>
      </div>
      <p>A mailcap file consists of a series of lines which are comments, blank, or definitions.</p>
      <p>A comment line consists of a # character followed by anything you want.</p>
      <p>A blank line is blank.</p>
      <p>A definition line consists of a content type, a view command, and any number of optional fields. Each field of a definition line is divided by a semicolon
      <span class="quote">“<span class="quote">;</span>”</span> character.</p>
      <p>The content type is specified in the MIME standard
      <span class="quote">“<span class="quote">type/subtype</span>”</span> notation. For example,
      <code class="literal">text/plain</code>,
      <code class="literal">text/html</code>,
      <code class="literal">image/gif</code>, etc. In addition, the mailcap format includes two formats for wildcards, one using the special
      <span class="quote">“<span class="quote">*</span>”</span> subtype, the other is the implicit wild, where you only include the major type. For example,
      <code class="literal">image/*</code>, or
      <code class="literal">video</code> will match all image types and video types, respectively.</p>
      <p>The view command is a Unix command for viewing the type specified. There are two different types of commands supported. The default is to send the body of the MIME message to the command on stdin. You can change this behavior by using
      <code class="literal">%s</code> as a parameter to your view command. This will cause NeoMutt to save the body of the MIME message to a temporary file, and then call the view command with the
      <code class="literal">%s</code> replaced by the name of the temporary file. In both cases, NeoMutt will turn over the terminal to the view program until the program quits, at which time NeoMutt will remove the temporary file if it exists. This means that mailcap does
      <span class="emphasis">
        <em>not</em>
      </span>work out of the box with programs which detach themselves from the terminal right after starting, like
      <code class="literal">open</code> on Mac OS X. In order to nevertheless use these programs with mailcap, you probably need custom shell scripts.</p>
      <p>So, in the simplest form, you can send a
      <code class="literal">text/plain</code> message to the external pager more on standard input:</p>
      <pre class="screen">
text/plain; more
</pre>
      <p>Or, you could send the message as a file:</p>
      <pre class="screen">
text/plain; more %s
</pre>
      <p>Perhaps you would like to use lynx to interactively view a
      <code class="literal">text/html</code> message:</p>
      <pre class="screen">
text/html; lynx %s
</pre>
      <p>In this case, lynx does not support viewing a file from standard input, so you must use the
      <code class="literal">%s</code> syntax.</p>
      <div class="note">
        <h3 class="title">Note</h3>
        <p>
          <span class="emphasis">
            <em>Some older versions of lynx contain a bug where they will check the mailcap file for a viewer for
            <code class="literal">text/html</code>. They will find the line which calls lynx, and run it. This causes lynx to continuously spawn itself to view the object.</em>
          </span>
        </p>
      </div>
      <p>On the other hand, maybe you don't want to use lynx interactively, you just want to have it convert the
      <code class="literal">text/html</code> to
      <code class="literal">text/plain</code>, then you can use:</p>
      <pre class="screen">
text/html; lynx -dump %s | more
</pre>
      <p>Perhaps you wish to use lynx to view
      <code class="literal">text/html</code> files, and a pager on all other text formats, then you would use the following:</p>
      <pre class="screen">
text/html; lynx %s
text/*; more
</pre>
    </div>
    <div class="sect2">
      <div class="titlepage">
        <div>
          <div>
            <h3 class="title">
            <a id="secure-mailcap"></a>3.2.&#160;Secure Use of Mailcap</h3>
          </div>
        </div>
      </div>
      <p>The interpretation of shell meta-characters embedded in MIME parameters can lead to security problems in general. NeoMutt tries to quote parameters in expansion of
      <code class="literal">%s</code> syntaxes properly, and avoids risky characters by substituting them, see the
      <a class="link" href="reference.html#mailcap-sanitize" title="3.228.&#160;mailcap_sanitize">$mailcap_sanitize</a> variable.</p>
      <p>Although NeoMutt's procedures to invoke programs with mailcap seem to be safe, there are other applications parsing mailcap, maybe taking less care of it. Therefore you should pay attention to the following rules:</p>
      <p>
      <span class="emphasis">
        <em>Keep the %-expandos away from shell quoting.</em>
      </span>Don't quote them with single or double quotes. NeoMutt does this for you, the right way, as should any other program which interprets mailcap. Don't put them into backtick expansions. Be highly careful with eval statements, and avoid them if possible at all. Trying to fix broken behavior with quotes introduces new leaks – there is no alternative to correct quoting in the first place.</p>
      <p>If you have to use the %-expandos' values in context where you need quoting or backtick expansions, put that value into a shell variable and reference the shell variable where necessary, as in the following example (using
      <code class="literal">$charset</code> inside the backtick expansion is safe, since it is not itself subject to any further expansion):</p>
      <pre class="screen">
text/test-mailcap-bug; cat %s; copiousoutput; test=charset=%{charset} \
        &amp;&amp; test "`echo $charset | tr '[A-Z]' '[a-z]'`" != iso-8859-1
</pre>
    </div>
    <div class="sect2">
      <div class="titlepage">
        <div>
          <div>
            <h3 class="title">
            <a id="advanced-mailcap"></a>3.3.&#160;Advanced Mailcap Usage</h3>
          </div>
        </div>
      </div>
      <div class="sect3">
        <div class="titlepage">
          <div>
            <div>
              <h4 class="title">
              <a id="optional-mailcap-fields"></a>3.3.1.&#160;Optional Fields</h4>
            </div>
          </div>
        </div>
        <p>In addition to the required content-type and view command fields, you can add semi-colon
        <span class="quote">“<span class="quote">;</span>”</span> separated fields to set flags and other options. NeoMutt recognizes the following optional fields:</p>
        <div class="variablelist">
          <dl class="variablelist">
            <dt>
              <span class="term">copiousoutput</span>
            </dt>
            <dd>
              <p>This flag tells NeoMutt that the command passes possibly large amounts of text on standard output. This causes NeoMutt to invoke a pager (either the internal pager or the external pager defined by the pager variable) on the output of the view command. Without this flag, NeoMutt assumes that the command is interactive. One could use this to replace the pipe to
              <code class="literal">more</code> in the
              <code class="literal">lynx -dump</code> example in the Basic section:</p>
              <pre class="screen">
text/html; lynx -dump %s ; copiousoutput
</pre>
              <p>This will cause lynx to format the
              <code class="literal">text/html</code> output as
              <code class="literal">text/plain</code> and NeoMutt will use your standard pager to display the results.</p>
              <p>NeoMutt will set the
              <code class="literal">COLUMNS</code> environment variable to the width of the pager. Some programs make use of this environment variable automatically. Others provide a command line argument that can use this to set the output width:</p>
              <pre class="screen">
text/html; lynx -dump -width ${COLUMNS:-80} %s; copiousoutput
</pre>
              <p>Note that when using the built-in pager,
              <span class="emphasis">
                <em>only</em>
              </span>entries with this flag will be considered a handler for a MIME type – all other entries will be ignored.</p>
            </dd>
            <dt>
              <span class="term">needsterminal</span>
            </dt>
            <dd>
              <p>NeoMutt uses this flag when viewing attachments with
              <a class="link" href="#auto-view" title="4.&#160;MIME Autoview">
                <span class="command">
                  <strong>auto_view</strong>
                </span>
              </a>, in order to decide whether it should honor the setting of the
              <a class="link" href="reference.html#wait-key" title="3.545.&#160;wait_key">$wait_key</a> variable or not. When an attachment is viewed using an interactive program, and the corresponding mailcap entry has a
              <span class="emphasis">
                <em>needsterminal</em>
              </span>flag, NeoMutt will use
              <a class="link" href="reference.html#wait-key" title="3.545.&#160;wait_key">$wait_key</a> and the exit status of the program to decide if it will ask you to press a key after the external program has exited. In all other situations it will not prompt you for a key.</p>
            </dd>
            <dt>
              <span class="term">compose=&lt;command&gt;</span>
            </dt>
            <dd>
              <p>This flag specifies the command to use to create a new attachment of a specific MIME type. NeoMutt supports this from the compose menu.</p>
            </dd>
            <dt>
              <span class="term">composetyped=&lt;command&gt;</span>
            </dt>
            <dd>
              <p>This flag specifies the command to use to create a new attachment of a specific MIME type. This command differs from the compose command in that NeoMutt will expect standard MIME headers on the data. This can be used to specify parameters, filename, description, etc. for a new attachment. NeoMutt supports this from the compose menu.</p>
            </dd>
            <dt>
              <span class="term">print=&lt;command&gt;</span>
            </dt>
            <dd>
              <p>This flag specifies the command to use to print a specific MIME type. NeoMutt supports this from the attachment and compose menus.</p>
            </dd>
            <dt>
              <span class="term">edit=&lt;command&gt;</span>
            </dt>
            <dd>
              <p>This flag specifies the command to use to edit a specific MIME type. NeoMutt supports this from the compose menu, and also uses it to compose new attachments. NeoMutt will default to the defined
              <a class="link" href="reference.html#editor" title="3.119.&#160;editor">$editor</a> for text attachments.</p>
            </dd>
            <dt>
              <span class="term">nametemplate=&lt;template&gt;</span>
            </dt>
            <dd>
              <p>This field specifies the format for the file denoted by
              <code class="literal">%s</code> in the command fields. Certain programs will require a certain file extension, for instance, to correctly view a file. For instance, lynx will only interpret a file as
              <code class="literal">text/html</code> if the file ends in
              <code class="literal">.html</code>. So, you would specify lynx as a
              <code class="literal">text/html</code> viewer with a line in the mailcap file like:</p>
              <pre class="screen">
text/html; lynx %s; nametemplate=%s.html
</pre>
            </dd>
            <dt>
              <span class="term">test=&lt;command&gt;</span>
            </dt>
            <dd>
              <p>This field specifies a command to run to test whether this mailcap entry should be used. The command is defined with the command expansion rules defined in the next section. If the command returns 0, then the test passed, and NeoMutt uses this entry. If the command returns non-zero, then the test failed, and NeoMutt continues searching for the right entry. Note that the content-type must match before NeoMutt performs the test. For example:</p>
              <pre class="screen">
text/html; firefox -remote 'openURL(%s)' ; test=RunningX
text/html; lynx %s
</pre>
              <p>In this example, NeoMutt will run the program
              <code class="literal">RunningX</code> which will return 0 if the X Window manager is running, and non-zero if it isn't. If
              <code class="literal">RunningX</code> returns 0, then NeoMutt will run firefox to display the
              <code class="literal">text/html</code> object. If RunningX doesn't return 0, then NeoMutt will go on to the next entry and use lynx to display the
              <code class="literal">text/html</code> object.</p>
            </dd>
            <dt>
              <span class="term">x-neomutt-keep</span>
            </dt>
            <dd>
              <p>
              <code class="literal">x-neomutt-keep</code> tells NeoMutt to
              <span class="emphasis">
                <em>not</em>
              </span>delete the temporary file after the program has been run.</p>
              <p>Using it allows you to control the lifespan of the temporary file. Without this option, the file will be deleted after
              <a class="link" href="reference.html#timeout" title="3.520.&#160;timeout">$timeout</a> seconds.</p>
              <pre class="screen">
text/html; firefox %s &amp; x-neomutt-keep
</pre>
            </dd>
            <dt>
              <span class="term">x-neomutt-nowrap</span>
            </dt>
            <dd>
              <p>
              <code class="literal">x-neomutt-nowrap</code> tells the NeoMutt pager to ignore the
              <a class="link" href="reference.html#wrap" title="3.547.&#160;wrap">$wrap</a> parameter and to assume the output from the mailcap command to already be correctly wrapped.</p>
              <pre class="screen">
text/html; /usr/local/bin/w3m -s -T text/html -o display_link_number=1 %s; nametemplate=%s.html; copiousoutput; x-neomutt-nowrap;
</pre>
            </dd>
          </dl>
        </div>
      </div>
      <div class="sect3">
        <div class="titlepage">
          <div>
            <div>
              <h4 class="title">
              <a id="mailcap-search-order"></a>3.3.2.&#160;Search Order</h4>
            </div>
          </div>
        </div>
        <p>When searching for an entry in the mailcap file, NeoMutt will search for the most useful entry for its purpose. For instance, if you are attempting to print an
        <code class="literal">image/gif</code>, and you have the following entries in your mailcap file, NeoMutt will search for an entry with the print command:</p>
        <pre class="screen">
image/*;        xv %s
image/gif;      ; print=anytopnm %s | pnmtops | lpr; \
                nametemplate=%s.gif
</pre>
        <p>NeoMutt will skip the
        <code class="literal">image/*</code> entry and use the
        <code class="literal">image/gif</code> entry with the print command.</p>
        <p>In addition, you can use this with
        <a class="link" href="#auto-view" title="4.&#160;MIME Autoview">
          <span class="command">
            <strong>auto_view</strong>
          </span>
        </a>to denote two commands for viewing an attachment, one to be viewed automatically, the other to be viewed interactively from the attachment menu using the
        <code class="literal">&lt;view-mailcap&gt;</code> function (bound to
        <span class="quote">“<span class="quote">m</span>”</span> by default). In addition, you can then use the test feature to determine which viewer to use interactively depending on your environment.</p>
        <pre class="screen">
text/html;      firefox -remote 'openURL(%s)' ; test=RunningX
text/html;      lynx %s; nametemplate=%s.html
text/html;      lynx -dump %s; nametemplate=%s.html; copiousoutput
</pre>
        <p>For
        <a class="link" href="#auto-view" title="4.&#160;MIME Autoview">
          <span class="command">
            <strong>auto_view</strong>
          </span>
        </a>, NeoMutt will choose the third entry because of the
        <code class="literal">copiousoutput</code> tag. For interactive viewing, NeoMutt will run the program
        <code class="literal">RunningX</code> to determine if it should use the first entry. If the program returns non-zero, NeoMutt will use the second entry for interactive viewing. The last entry is for inline display in the pager and the
        <code class="literal">&lt;view-attach&gt;</code> function in the attachment menu.</p>
        <p>Entries with the
        <code class="literal">copiousoutput</code> tag should always be specified as the last one per type. For non-interactive use, the last entry will then actually be the first matching one with the tag set. For non-interactive use, only
        <code class="literal">copiousoutput</code>-tagged entries are considered. For interactive use, NeoMutt ignores this tag and treats all entries equally. Therefore, if not specified last, all following entries without this tag would never be considered for
        <code class="literal">&lt;view-attach&gt;</code> because the
        <code class="literal">copiousoutput</code> before them matched already.</p>
      </div>
      <div class="sect3">
        <div class="titlepage">
          <div>
            <div>
              <h4 class="title">
              <a id="mailcap-command-expansion"></a>3.3.3.&#160;Command Expansion</h4>
            </div>
          </div>
        </div>
        <p>The various commands defined in the mailcap files are passed to the
        <code class="literal">/bin/sh</code> shell using the
        <code class="literal">system(3)</code> function. Before the command is passed to
        <code class="literal">/bin/sh -c</code>, it is parsed to expand various special parameters with information from NeoMutt. The keywords NeoMutt expands are:</p>
        <div class="variablelist">
          <dl class="variablelist">
            <dt>
              <span class="term">%s</span>
            </dt>
            <dd>
              <p>As seen in the basic mailcap section, this variable is expanded to a filename specified by the calling program. This file contains the body of the message to view/print/edit or where the composing program should place the results of composition. In addition, the use of this keyword causes NeoMutt to not pass the body of the message to the view/print/edit program on stdin.</p>
            </dd>
            <dt>
              <span class="term">%t</span>
            </dt>
            <dd>
              <p>NeoMutt will expand
              <code class="literal">%t</code> to the text representation of the content type of the message in the same form as the first parameter of the mailcap definition line, i.e.
              <code class="literal">text/html</code> or
              <code class="literal">image/gif</code>.</p>
            </dd>
            <dt>
              <span class="term">%{&lt;parameter&gt;}</span>
            </dt>
            <dd>
              <p>NeoMutt will expand this to the value of the specified parameter from the Content-Type: line of the mail message. For instance, if your mail message contains:</p>
              <pre class="screen">
Content-Type: text/plain; charset=iso-8859-1
</pre>
              <p>then NeoMutt will expand
              <code class="literal">%{charset}</code> to
              <span class="quote">“<span class="quote">iso-8859-1</span>”</span>. The default metamail mailcap file uses this feature to test the charset to spawn an xterm using the right charset to view the message.</p>
            </dd>
            <dt>
              <span class="term">\%</span>
            </dt>
            <dd>
              <p>This will be replaced by a literal
              <code class="literal">%</code>.</p>
            </dd>
          </dl>
        </div>
        <p>NeoMutt does not currently support the
        <code class="literal">%F</code> and
        <code class="literal">%n</code> keywords specified in RFC1524. The main purpose of these parameters is for multipart messages, which is handled internally by NeoMutt.</p>
      </div>
    </div>
    <div class="sect2">
      <div class="titlepage">
        <div>
          <div>
            <h3 class="title">
            <a id="mailcap-example"></a>3.4.&#160;Example Mailcap Files</h3>
          </div>
        </div>
      </div>
      <p>This mailcap file is fairly simple and standard:</p>
      <pre class="screen">
<span class="comment"># I'm always running X :)</span>
video/*;        xanim %s &gt; /dev/null
image/*;        xv %s &gt; /dev/null
<span class="comment"># I'm always running firefox (if my computer had more memory, maybe)</span>
text/html;      firefox -remote 'openURL(%s)'
</pre>
      <p>These mailcap files shows how to control the lifespan of the temporary file.</p>
      <pre class="screen">
<span class="comment"># The `display` program shows an image and doesn't return until the user quits.</span>

<span class="comment"># Display an image, but wait for the user to quit the display program.</span>
<span class="comment"># When the user quits control will return to NeoMutt.</span>
image/png; display %s;

<span class="comment"># Display an image and return to NeoMutt immediately.</span>
image/png; display %s &amp;;

<span class="comment"># The file will be automatically deleted after $timeout seconds.</span>
</pre>
      <pre class="screen">
<span class="comment"># Some graphical programs return immediately if they're already running.</span>
<span class="comment"># We'll add an ampersand (&amp;), just in case they're not.</span>

<span class="comment"># View the contents of a 'tar' file.</span>
<span class="comment"># The file will be automatically deleted after $timeout seconds.</span>
application/x-tar; file-roller %s &amp;;

<span class="comment"># View the contents of a 'tar' file.</span>
<span class="comment"># The file will
<span class="emphasis">
  <em>not</em>
</span> be deleted.</span>
application/x-tar; file-roller %s &amp;; x-neomutt-keep
</pre>
      <pre class="screen">
<span class="comment"># Some programs watch any files they have open.</span>
<span class="comment"># If NeoMutt deleted the file, the program would close prematurely.</span>

<span class="comment"># Use a custom script to manage the file's lifespan.</span>
application/pdf; my-pdf-script.sh %s; x-neomutt-keep
</pre>
      <p>This mailcap file shows quite a number of examples:</p>
      <pre class="screen">
<span class="comment"># Use xanim to view all videos Xanim produces a header on startup,</span>
<span class="comment"># send that to /dev/null so I don't see it</span>
video/*;        xanim %s &gt; /dev/null
<span class="comment"># Send html to a running firefox by remote</span>
text/html;      firefox -remote 'openURL(%s)'; test=RunningFirefox
<span class="comment"># If I'm not running firefox but I am running X, start firefox on the</span>
<span class="comment"># object</span>
text/html;      firefox %s; test=RunningX
<span class="comment"># Else use lynx to view it as text</span>
text/html;      lynx %s
<span class="comment"># This version would convert the text/html to text/plain</span>
text/html;      lynx -dump %s; copiousoutput
<span class="comment"># I use enscript to print text in two columns to a page</span>
text/*;         more %s; print=enscript -2Gr %s
<span class="comment"># Firefox adds a flag to tell itself to view jpegs internally</span>
image/jpeg;     xv %s; x-mozilla-flags=internal
<span class="comment"># Use xv to view images if I'm running X</span>
<span class="comment"># In addition, this uses the \ to extend the line and set my editor</span>
<span class="comment"># for images</span>
image/*;        xv %s; test=RunningX; edit=xpaint %s
<span class="comment"># Convert images to text using the netpbm tools</span>
image/*;        (anytopnm %s | pnmscale -xysize 80 46 | ppmtopgm | pgmtopbm | \
                pbmtoascii -1x2) 2&gt;&amp;1 ; copiousoutput
<span class="comment"># Send excel spreadsheets to my NT box</span>
application/ms-excel;   open.pl %s
</pre>
    </div>
  </div>
  <div class="sect1">
    <div class="titlepage">
      <div>
        <div>
          <h2 class="title" style="clear: both">
          <a id="auto-view"></a>4.&#160;MIME Autoview</h2>
        </div>
      </div>
    </div>
    <p>Usage:</p>
    <div class="cmdsynopsis">
      <p>
      <code class="command">auto_view</code>
      <em class="replaceable">
        <code>mime-type</code>
      </em>[
      <em class="replaceable">
        <code>/mime-subtype</code>
      </em>] [
      <em class="replaceable">
        <code>mime-type</code>
      </em>[
      <em class="replaceable">
        <code>/mime-subtype</code>
      </em>] ...]
      <br />
      <code class="command">unauto_view</code> { * | [
      <em class="replaceable">
        <code>mime-type</code>
      </em>[
      <em class="replaceable">
        <code>/mime-subtype</code>
      </em>] ...]}</p>
    </div>
    <p>In addition to explicitly telling NeoMutt to view an attachment with the MIME viewer defined in the mailcap file from the attachments menu, NeoMutt has support for automatically viewing MIME attachments while in the pager.</p>
    <p>For this to work, you must define a viewer in the mailcap file which uses the
    <code class="literal">copiousoutput</code> option to denote that it is non-interactive. Usually, you also use the entry to convert the attachment to a text representation which you can view in the pager.</p>
    <p>You then use the
    <span class="command">
      <strong>auto_view</strong>
    </span>configuration command to list the content-types that you wish to view automatically. For instance, if you set it to:</p>
    <pre class="screen">
auto_view text/html application/x-gunzip \
  application/postscript image/gif application/x-tar-gz
</pre>
    <p>...NeoMutt would try to find corresponding entries for rendering attachments of these types as text. A corresponding mailcap could look like:</p>
    <pre class="screen">
text/html;              lynx -dump %s; copiousoutput; nametemplate=%s.html
image/*;                anytopnm %s | pnmscale -xsize 80 -ysize 50 | ppmtopgm | \
                        pgmtopbm | pbmtoascii ; copiousoutput
application/x-gunzip;   gzcat; copiousoutput
application/x-tar-gz;   gunzip -c %s | tar -tf - ; copiousoutput
application/postscript; ps2ascii %s; copiousoutput
</pre>
    <p>
    <span class="command">
      <strong>unauto_view</strong>
    </span>can be used to remove previous entries from the
    <span class="command">
      <strong>auto_view</strong>
    </span>list. This can be used with
    <a class="link" href="configuration.html#message-hook" title="20.&#160;Change Settings Before Formatting a Message">
      <span class="command">
        <strong>message-hook</strong>
      </span>
    </a>to autoview messages based on size, etc.
    <span class="quote">“<span class="quote">
    <span class="command">
      <strong>unauto_view</strong>
    </span>&#160;*</span>”</span> will remove all previous entries.</p>
  </div>
  <div class="sect1">
    <div class="titlepage">
      <div>
        <div>
          <h2 class="title" style="clear: both">
          <a id="alternative-order"></a>5.&#160;MIME Multipart/Alternative</h2>
        </div>
      </div>
    </div>
    <p>A
    <code class="literal">multipart/alternative</code> email has several parts that represent the same content in different formats, such as
    <code class="literal">text/plain</code> and
    <code class="literal">text/html</code>. This kind of email is heavily used by many modern mail user agents to send HTML messages which contain an alternative plain text representation. You can read and write
    <code class="literal">multipart/alternative</code> emails in NeoMutt.</p>
    <div class="sect2">
      <div class="titlepage">
        <div>
          <div>
            <h3 class="title">
            <a id="read-alternative-order"></a>5.1.&#160;Reading Multipart/Alternative Emails</h3>
          </div>
        </div>
      </div>
      <p>NeoMutt has some heuristics for determining which attachment of a
      <code class="literal">multipart/alternative</code> type to display:</p>
      <div class="orderedlist">
        <ol class="orderedlist" type="1">
          <li class="listitem">
            <p>First, NeoMutt will check the
            <span class="command">
              <strong>alternative_order</strong>
            </span>list to determine if one of the available types is preferred. It consists of a number of MIME types in order, including support for implicit and explicit wildcards. For example:</p>
            <pre class="screen">
alternative_order text/enriched text/plain text application/postscript image/*
</pre>
          </li>
          <li class="listitem">
            <p>Next, NeoMutt will check if any of the types have a defined
            <a class="link" href="#auto-view" title="4.&#160;MIME Autoview">
              <span class="command">
                <strong>auto_view</strong>
              </span>
            </a>, and use that.</p>
          </li>
          <li class="listitem">
            <p>Failing that, NeoMutt will look first for
            <code class="literal">text/enriched</code>, followed by
            <code class="literal">text/plain</code>, and finally
            <code class="literal">text/html</code>.</p>
          </li>
          <li class="listitem">
            <p>As a last attempt, NeoMutt will look for any type it knows how to handle.</p>
          </li>
        </ol>
      </div>
      <p>To remove a MIME type from the
      <span class="command">
        <strong>alternative_order</strong>
      </span>list, use the
      <span class="command">
        <strong>unalternative_order</strong>
      </span>command.</p>
    </div>
    <div class="sect2">
      <div class="titlepage">
        <div>
          <div>
            <h3 class="title">
            <a id="compose-alternative-order"></a>5.2.&#160;Composing Multipart/Alternative Emails</h3>
          </div>
        </div>
      </div>
      <p>Noemutt includes some primitive ability to compose multipart/alternative emails:</p>
      <div class="orderedlist">
        <ol class="orderedlist" type="1">
          <li class="listitem">
            <p>In the Compose menu, attach the two (or more) alternatives as usual. For example, attach "invitation.html" and then "invitation.txt". (You can reorder them using the
            <code class="literal">&lt;move-up&gt;</code> (-) and
            <code class="literal">&lt;move-down&gt;</code> (+) bindings, and edit the descriptions).</p>
          </li>
          <li class="listitem">
            <p>Tag the attachments that are alternatives, and press the
            <code class="literal">&lt;group-alternatives&gt;</code> (&amp;) binding to group them together. After this, the separate parts will be displayed in a tree structure. Attachments can still be edited separately and reordered within the group, but must be ungrouped using the
            <code class="literal">&lt;ungroup-attachment&gt;</code> (#) binding for more advanced editing before tagging and grouping together again as described above.</p>
          </li>
          <li class="listitem">
            <p>Send the email as usual.</p>
          </li>
        </ol>
      </div>
      <p>If all the attachments have been grouped and form a single
      <code class="literal">multipart/alternative</code>, part then this message will be sent as a
      <code class="literal">multipart/alternative</code> email, otherwise it will be sent as a
      <code class="literal">multipart/mixed</code> email.</p>
      <p>Be aware that when sending a
      <code class="literal">multipart/alternative</code> email, you have to manually prepare the alternative parts and attach them. However, you can use Neomutt's macro to perform all the operations needed, such that you can compose a plain text email as usual and turn that into a
      <code class="literal">multipart/alternative</code> email in one single command, with one part being
      <code class="literal">text/plain</code> and the other
      <code class="literal">text/html</code>. An example macro which adds an HTML part to the main body of an email and sends it could be the following:</p>
      <pre class="screen">
macro compose Y "&lt;first-entry&gt;&lt;enter-command&gt;set wait_key=no&lt;enter&gt;\
&lt;pipe-entry&gt;pandoc -o /tmp/neomutt-alternative.html&lt;enter&gt;\
&lt;attach-file&gt;/tmp/neomutt-alternative.html&lt;enter&gt;\
&lt;toggle-unlink&gt;&lt;toggle-disposition&gt;\
&lt;tag-entry&gt;&lt;first-entry&gt;&lt;tag-entry&gt;&lt;group-alternatives&gt;\
&lt;enter-command&gt;set wait_key=yes&lt;enter&gt;&lt;send-message&gt;" \
"send the message as 'multipart/alternative'"
</pre>
      <p></p>
    </div>
  </div>
  <div class="sect1">
    <div class="titlepage">
      <div>
        <div>
          <h2 class="title" style="clear: both">
          <a id="multipart-multilingual"></a>6.&#160;MIME Multipart/Multilingual</h2>
        </div>
      </div>
    </div>
    <p>Neomutt includes supports for reading and writing
    <code class="literal">multipart/multilingual</code> emails. A
    <code class="literal">multipart/multilingual</code> email is like a
    <code class="literal">multipart/alternative</code> email, except that it comes with parts of different versions of languages instead of appearances. Its format is described by
    <a class="ulink" href="https://tools.ietf.org/html/rfc8255" target="_top">RFC8255</a>.</p>
    <div class="sect2">
      <div class="titlepage">
        <div>
          <div>
            <h3 class="title">
            <a id="read-multipart-multilingual"></a>6.1.&#160;Reading Multipart/Multilingual Emails</h3>
          </div>
        </div>
      </div>
      <p>Neomutt uses the
      <code class="literal">$preferred_languages</code> variable to determine which languages to display when displaying a
      <code class="literal">multipart/multilingual</code> email. You can have several preferred languages, separated by
      <code class="literal">,</code></p>
      <pre class="screen">
set preferred_languages="fr,en,de"
</pre>
      <p>Neomutt will try to match these strings again the multilingual header in the received emails "by prefix", e.g.,
      <code class="literal">en</code> will match both
      <code class="literal">en</code> and
      <code class="literal">en_US</code>.</p>
      <p>If
      <code class="literal">$preferred_languages</code> is not set, it default to None, and the first part of the received
      <code class="literal">multipart/multilingual</code> email will be displayed.</p>
    </div>
    <div class="sect2">
      <div class="titlepage">
        <div>
          <div>
            <h3 class="title">
            <a id="compose-multipart-alternative"></a>6.2.&#160;Composing Multipart/Multilingual Emails</h3>
          </div>
        </div>
      </div>
      <p>The procedures of composing a
      <code class="literal">multipart/multilingual</code> email is similar to those in
      <a class="link" href="#compose-alternative-order" title="5.2.&#160;Composing Multipart/Alternative Emails">Composing Multipart/Alternative</a>. You have to prepare every part manually or using some scripts, and then tag and group them together into a
      <code class="literal">multipart/multilingual</code> bundle before sending it:</p>
      <div class="orderedlist">
        <ol class="orderedlist" type="1">
          <li class="listitem">
            <p>Prepare parts of the multilingual emails.</p>
          </li>
          <li class="listitem">
            <p>Attach them as attachments.</p>
          </li>
          <li class="listitem">
            <p>Tag them with
            <code class="literal">&lt;tag-entry&gt;</code></p>
          </li>
          <li class="listitem">
            <p>Edit the
            <code class="literal">Content-Language</code> header of every attachment with command
            <code class="literal">&lt;edit-language&gt;</code> (default to
            <code class="literal">Ctrl-L</code> ). This is important, otherwise the recipient of this email will not know the corresponding languages. You can set arbitrary string as
            <code class="literal">Content-Language</code>, but it is recommended to set it as some common prefixes such as "en", "zh" and "fr".</p>
          </li>
          <li class="listitem">
            <p>Group all the tag messages together by
            <code class="literal">&lt;group-multilingual&gt;</code> (default to
            <code class="literal">^</code> ).</p>
          </li>
          <li class="listitem">
            <p>Send the email as usual.</p>
          </li>
        </ol>
      </div>
      <p>As in
      <a class="link" href="#compose-alternative-order" title="5.2.&#160;Composing Multipart/Alternative Emails">Composing Multipart/Alternative</a>, you can also use Neomutt's macro and some external scripts to combine this procedure into one.</p>
      <p>After grouping the separate parts will be displayed in a tree structure. Attachments can still be edited separately and reordered within the group, but must be ungrouped using the
      <code class="literal">&lt;ungroup-attachment&gt;</code> (#) binding for more advanced editing before tagging and grouping together again as described above.</p>
    </div>
  </div>
  <div class="sect1">
    <div class="titlepage">
      <div>
        <div>
          <h2 class="title" style="clear: both">
          <a id="related"></a>7.&#160;MIME Multipart/Related</h2>
        </div>
      </div>
    </div>
    <p>Neomutt doesn't include any special support for reading
    <code class="literal">multipart/related</code> emails, but it is possible to write a
    <code class="literal">multipart/related</code> email. A
    <code class="literal">multipart/related</code> attachment is intended for compound objects consisting of several inter-related body parts which are linked together using the
    <code class="literal">Content-ID</code> header. Its format is described by
    <a class="ulink" href="https://tools.ietf.org/html/rfc2387" target="_top">RFC2387</a>.</p>
    <div class="sect2">
      <div class="titlepage">
        <div>
          <div>
            <h3 class="title">
            <a id="compose-multipart-related"></a>7.1.&#160;Composing Multipart/Related Emails</h3>
          </div>
        </div>
      </div>
      <p>The procedure for composing a
      <code class="literal">multipart/related</code> email is similar to that in
      <a class="link" href="#compose-alternative-order" title="5.2.&#160;Composing Multipart/Alternative Emails">Composing Multipart/Alternative</a>. You have to prepare every part manually or using some scripts, and then tag and group them together into a
      <code class="literal">multipart/related</code> bundle before sending it:</p>
      <div class="orderedlist">
        <ol class="orderedlist" type="1">
          <li class="listitem">
            <p>Prepare parts of the related email.</p>
          </li>
          <li class="listitem">
            <p>Attach them as attachments.</p>
          </li>
          <li class="listitem">
            <p>Tag them with
            <code class="literal">&lt;tag-entry&gt;</code></p>
          </li>
          <li class="listitem">
            <p>One part can reference another using its
            <code class="literal">Content-ID</code> header. For example, an HTML part that includes an embedded image needs to contain:
            <code class="literal">&lt;img src="cid:content-id"&gt;</code> where an attached image has a
            <code class="literal">Content-ID</code> header of
            <code class="literal">content-id</code>. The
            <code class="literal">Content-ID</code> of an attachment can be set using
            <code class="literal">&lt;edit-content-id&gt;</code> (default key
            <code class="literal">Alt-i</code> ).
            <code class="literal">&lt;edit-content-id&gt;</code> sets a random ID which can then be changed if desired. Permitted characters for
            <code class="literal">Content-ID</code> are:
            <code class="literal">-.0-9@A-Z_a-z</code>.</p>
            <p>If the
            <code class="literal">multipart/related</code> group is intended to be inline, members of the group should also have their
            <code class="literal">Content-Disposition</code> header set to
            <code class="literal">inline</code> which can be toggled using
            <code class="literal">&lt;toggle-disposition&gt;</code> (default key
            <code class="literal">Ctrl-D</code> ).</p>
            <p>It can also be desirable to give referenced files in the group a
            <code class="literal">filename</code> even when the
            <code class="literal">Content-Disposition</code> is set to be
            <code class="literal">inline</code>. To do this use
            <code class="literal">&lt;rename-attachment&gt;</code> (default key
            <code class="literal">Ctrl-O</code> ).</p>
          </li>
          <li class="listitem">
            <p>Group all the tagged messages together with
            <code class="literal">&lt;group-related&gt;</code> (default key
            <code class="literal">%</code> ).</p>
            <p>Top level attachments (excluding
            <code class="literal">multipart</code> ones) in the group are automatically given a random
            <code class="literal">Content-ID</code> if they do not already have one.</p>
          </li>
          <li class="listitem">
            <p>Send the email as usual.</p>
          </li>
        </ol>
      </div>
      <p>Some care needs to be taken with the construction of a
      <code class="literal">multipart/related</code> email to ensure it is correctly displayed by the receiving mail client. A typical email with a
      <code class="literal">multipart/alternative</code> part containing a
      <code class="literal">text/plain</code> part and a
      <code class="literal">text/html</code> part with an embedded image, along with a separate attachment might end up like this:</p>
      <pre class="screen">
  I     1 &lt;no description&gt;                                         [multipart/related, 7bit, 0K]
  I     2 ├─&gt;&lt;no description&gt;                                  [multipart/alternative, 7bit, 0K]
- I     3 │ ├─&gt;/tmp/neomutt-hostname-XXXX-XXXXXX-XXXXXXXXXX   [text/plain, 7bit, us-ascii, 0.1K]
- I     4 │ └─&gt;/tmp/neomutt-alternative.html                      [text/html, 8bit, utf-8, 0.6K]
  I     5 └─&gt;image.png                                                  [image/png, base64, 19K]
  A     6 attachment.pdf                                         [application/pdf, quoted, 7.1K]
</pre>
      <p>In the above email
      <code class="literal">/tmp/neomutt-alternative.html</code> would reference
      <code class="literal">image.png</code> using
      <code class="literal">&lt;img src="cid:content-id"&gt;</code> and
      <code class="literal">image.png</code> has been given an explicit name of
      <code class="literal">image.png</code> using
      <code class="literal">&lt;rename-attachment&gt;</code> (regardless of its initial filename).
      <code class="literal">&lt;group-related&gt;</code> has set its
      <code class="literal">Content-ID</code> header to a random value.</p>
    </div>
  </div>
  <div class="sect1">
    <div class="titlepage">
      <div>
        <div>
          <h2 class="title" style="clear: both">
          <a id="attachments"></a>8.&#160;Attachment Searching and Counting</h2>
        </div>
      </div>
    </div>
    <p>If you ever lose track of attachments in your mailboxes, NeoMutt's attachment-counting and -searching support might be for you. You can make your message index display the number of qualifying attachments in each message, or search for messages by attachment count. You also can configure what kinds of attachments qualify for this feature with the
    <span class="command">
      <strong>attachments</strong>
    </span>and
    <span class="command">
      <strong>unattachments</strong>
    </span>commands.</p>
    <p>In order to provide this information, NeoMutt needs to fully MIME-parse all messages affected first. This can slow down operation especially for remote mail folders such as IMAP because all messages have to be downloaded first regardless whether the user really wants to view them or not though using
    <a class="xref" href="optionalfeatures.html#body-caching" title="8.2.&#160;Body Caching">Section&#160;8.2, “Body Caching”</a> usually means to download the message just once.</p>
    <p>By default, NeoMutt will not search inside
    <code class="literal">multipart/alternative</code> containers. This can be changed via the
    <a class="link" href="reference.html#count-alternatives" title="3.75.&#160;count_alternatives">$count_alternatives</a> configuration variable.</p>
    <p>The syntax is:</p>
    <div class="cmdsynopsis">
      <p>
      <code class="command">attachments</code> { + | - }
      <em class="replaceable">
        <code>disposition</code>
      </em>
      <em class="replaceable">
        <code>mime-type</code>
      </em>[
      <em class="replaceable">
        <code>mime-type</code>
      </em>...]
      <br />
      <code class="command">unattachments</code> { + | - }
      <em class="replaceable">
        <code>disposition</code>
      </em>
      <em class="replaceable">
        <code>mime-type</code>
      </em>[
      <em class="replaceable">
        <code>mime-type</code>
      </em>...]
      <br />
      <code class="command">attachments</code>
      <code class="option">?</code>
      <br />
      <code class="command">unattachments</code>
      <code class="option">*</code></p>
    </div>
    <p>
    <span class="emphasis">
      <em>disposition</em>
    </span>is the attachment's Content-Disposition type – either
    <code class="literal">inline</code> or
    <code class="literal">attachment</code>. You can abbreviate this to
    <code class="literal">I</code> or
    <code class="literal">A</code>.</p>
    <p>Disposition is prefixed by either a
    <span class="quote">“<span class="quote">+</span>”</span> symbol or a
    <span class="quote">“<span class="quote">-</span>”</span> symbol. If it's a
    <span class="quote">“<span class="quote">+</span>”</span>, you're saying that you want to allow this disposition and MIME type to qualify. If it's a
    <span class="quote">“<span class="quote">-</span>”</span>, you're saying that this disposition and MIME type is an exception to previous
    <span class="quote">“<span class="quote">+</span>”</span> rules. There are examples below of how this is useful.</p>
    <p>
    <span class="emphasis">
      <em>mime-type</em>
    </span>is the MIME type of the attachment you want the command to affect. A MIME type is always of the format
    <code class="literal">major/minor</code>, where
    <code class="literal">major</code> describes the broad category of document you're looking at, and
    <code class="literal">minor</code> describes the specific type within that category. The major part of mime-type must be literal text (or the special token
    <span class="quote">“<span class="quote">
      <code class="literal">*</code>
    </span>”</span>), but the minor part may be a regular expression. (Therefore,
    <span class="quote">“<span class="quote">
      <code class="literal">*/.*</code>
    </span>”</span> matches any MIME type.)</p>
    <p>The MIME types you give to the
    <span class="command">
      <strong>attachments</strong>
    </span>directive are a kind of pattern. When you use the
    <span class="command">
      <strong>attachments</strong>
    </span>directive, the patterns you specify are added to a list. When you use
    <span class="command">
      <strong>unattachments</strong>
    </span>, the pattern is removed from the list. The patterns are not expanded and matched to specific MIME types at this time – they're just text in a list. They're only matched when actually evaluating a message.</p>
    <p>Note that the first MIME part is treated slightly differently: It is almost always the message text. Thus, it is not counted as an attachment if its disposition is
    <code class="literal">inline</code> and it is not a
    <code class="literal">multipart/*</code> or
    <code class="literal">message/*</code> MIME-type.</p>
    <p>Some examples might help to illustrate. The examples that are not commented out define the default configuration of the lists.</p>
    <div class="example">
      <a id="ex-attach-count"></a>
      <p class="title">
        <strong>Example&#160;5.2.&#160;Attachment counting</strong>
      </p>
      <div class="example-contents">
        <pre class="screen">
<span class="comment"># Removing a pattern from a list removes that pattern literally. It</span>
<span class="comment"># does not remove any type matching the pattern.</span>
<span class="comment">#</span>
<span class="comment">#  attachments   +A */.*</span>
<span class="comment">#  attachments   +A image/jpeg</span>
<span class="comment">#  unattachments +A */.*</span>
<span class="comment">#</span>
<span class="comment"># This leaves "attached" image/jpeg files on the allowed attachments</span>
<span class="comment"># list. It does not remove all items, as you might expect, because the</span>
<span class="comment"># second */.* is not a matching expression at this time.</span>
<span class="comment">#</span>
<span class="comment"># Remember: "unattachments" only undoes what "attachments" has done!</span>
<span class="comment"># It does not trigger any matching on actual messages.</span>
<span class="comment">#</span>
<span class="comment"># Qualify any MIME part with an "attachment" disposition, EXCEPT for</span>
<span class="comment"># text/vcard, text/x-vcard, application/pgp.*, application/pkcs7-.* and</span>
<span class="comment"># application/x-pkcs7-.* parts. (PGP and S/MIME parts are already known</span>
<span class="comment"># to NeoMutt, and can be searched for with ~g, ~G, and ~k.)</span>
<span class="comment">#</span>
<span class="comment"># I've added pkcs7/x-pkcs7 to this, since it functions (for S/MIME)</span>
<span class="comment"># analogously to PGP signature attachments. S/MIME isn't supported</span>
<span class="comment"># in a stock NeoMutt build, but we can still treat it specially here.</span>
<span class="comment">#</span>
attachments  +A */.*
attachments  -A text/vcard text/x-vcard
attachments  -A application/pgp.*
attachments  -A application/pkcs7-.* application/x-pkcs7-.*
<span class="comment"># Discount all MIME parts with an "inline" disposition, unless they're</span>
<span class="comment"># text/plain. (Why inline a text/plain part unless it's external to the</span>
<span class="comment"># message flow?)</span>
attachments  +I text/plain
<span class="comment"># These two lines make NeoMutt qualify MIME containers. (So, for example,</span>
<span class="comment"># a message/rfc822 forward will count as an attachment.) The first</span>
<span class="comment"># line is unnecessary if you already have "attach-allow */.*", of</span>
<span class="comment"># course. These are off by default! The MIME elements contained</span>
<span class="comment"># within a message/* or multipart/* are still examined, even if the</span>
<span class="comment"># containers themselves don't qualify.</span>
<span class="comment"># Recursion into multipart/alternatives containers is controlled by the</span>
<span class="comment"># $count_alternatives setting.</span>

<span class="comment">#attachments  +A message/.* multipart/.*</span>
<span class="comment">#attachments  +I message/.* multipart/.*</span>
<span class="comment">## You probably don't really care to know about deleted attachments.</span>
attachments  -A message/external-body
attachments  -I message/external-body
</pre>
      </div>
    </div>
    <br class="example-break" />
    <p>Entering the command
    <span class="quote">“<span class="quote">
    <span class="command">
      <strong>attachments</strong>
    </span>?</span>”</span> as a command will list your current settings in neomuttrc format, so that it can be pasted elsewhere.</p>
    <p>Entering the command
    <span class="quote">“<span class="quote">
    <span class="command">
      <strong>unattachments</strong>
    </span>*</span>”</span> as a command will Clear all attachment settings.</p>
  </div>
  <div class="sect1">
    <div class="titlepage">
      <div>
        <div>
          <h2 class="title" style="clear: both">
          <a id="mime-lookup"></a>9.&#160;MIME Lookup</h2>
        </div>
      </div>
    </div>
    <p>Usage:</p>
    <div class="cmdsynopsis">
      <p>
      <code class="command">mime_lookup</code>
      <em class="replaceable">
        <code>mime-type</code>
      </em>[
      <em class="replaceable">
        <code>/mime-subtype</code>
      </em>] [
      <em class="replaceable">
        <code>mime-type</code>
      </em>[
      <em class="replaceable">
        <code>/mime-subtype</code>
      </em>] ...]
      <br />
      <code class="command">unmime_lookup</code> { * | [
      <em class="replaceable">
        <code>mime-type</code>
      </em>[
      <em class="replaceable">
        <code>/mime-subtype</code>
      </em>] ...]}</p>
    </div>
    <p>NeoMutt's
    <span class="command">
      <strong>mime_lookup</strong>
    </span>list specifies a list of MIME types that should
    <span class="emphasis">
      <em>not</em>
    </span>be treated according to their mailcap entry. This option is designed to deal with binary types such as
    <code class="literal">application/octet-stream</code>. When an attachment's MIME type is listed in
    <span class="command">
      <strong>mime_lookup</strong>
    </span>, then the extension of the filename will be compared to the list of extensions in the
    <code class="literal">mime.types</code> file. The MIME type associated with this extension will then be used to process the attachment according to the rules in the mailcap file and according to any other configuration options (such as
    <span class="command">
      <strong>auto_view</strong>
    </span>) specified. Common usage would be:</p>
    <pre class="screen">
mime_lookup application/octet-stream application/X-Lotus-Manuscript
</pre>
    <p>In addition, the
    <code class="literal">unmime_lookup</code> command may be used to disable this feature for any particular MIME type if it had been set, for example, in a global
    <code class="literal">.neomuttrc</code>.</p>
  </div>
</div>
{% endraw %}
